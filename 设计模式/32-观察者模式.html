<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>观察者模式 | JAVA设计模式</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="JAVA设计模式">
    
    <link rel="preload" href="/design-pattern/assets/css/0.styles.5341db10.css" as="style"><link rel="preload" href="/design-pattern/assets/js/app.45f4ed8b.js" as="script"><link rel="preload" href="/design-pattern/assets/js/2.dd66b6b4.js" as="script"><link rel="preload" href="/design-pattern/assets/js/13.8387bba7.js" as="script"><link rel="prefetch" href="/design-pattern/assets/js/10.e7bcc2af.js"><link rel="prefetch" href="/design-pattern/assets/js/11.a7e17509.js"><link rel="prefetch" href="/design-pattern/assets/js/12.5deb2685.js"><link rel="prefetch" href="/design-pattern/assets/js/14.6c42d1b1.js"><link rel="prefetch" href="/design-pattern/assets/js/15.3cb5bbbe.js"><link rel="prefetch" href="/design-pattern/assets/js/16.e60f62c7.js"><link rel="prefetch" href="/design-pattern/assets/js/17.f4ca0f28.js"><link rel="prefetch" href="/design-pattern/assets/js/18.be2874bb.js"><link rel="prefetch" href="/design-pattern/assets/js/19.98f55331.js"><link rel="prefetch" href="/design-pattern/assets/js/20.693bdd6c.js"><link rel="prefetch" href="/design-pattern/assets/js/21.cd7cac49.js"><link rel="prefetch" href="/design-pattern/assets/js/22.afafc6f9.js"><link rel="prefetch" href="/design-pattern/assets/js/23.f5f36a02.js"><link rel="prefetch" href="/design-pattern/assets/js/24.2761ed7d.js"><link rel="prefetch" href="/design-pattern/assets/js/25.73a46f0c.js"><link rel="prefetch" href="/design-pattern/assets/js/26.6afae513.js"><link rel="prefetch" href="/design-pattern/assets/js/27.9e44b99e.js"><link rel="prefetch" href="/design-pattern/assets/js/28.888ee2c2.js"><link rel="prefetch" href="/design-pattern/assets/js/29.89b373e8.js"><link rel="prefetch" href="/design-pattern/assets/js/3.704ac8ee.js"><link rel="prefetch" href="/design-pattern/assets/js/30.c1e53709.js"><link rel="prefetch" href="/design-pattern/assets/js/31.a53c8f9e.js"><link rel="prefetch" href="/design-pattern/assets/js/32.cd9a54d0.js"><link rel="prefetch" href="/design-pattern/assets/js/33.3efcfa5b.js"><link rel="prefetch" href="/design-pattern/assets/js/34.5bad324b.js"><link rel="prefetch" href="/design-pattern/assets/js/35.2f4dac27.js"><link rel="prefetch" href="/design-pattern/assets/js/36.06a6c412.js"><link rel="prefetch" href="/design-pattern/assets/js/37.139a7bc2.js"><link rel="prefetch" href="/design-pattern/assets/js/38.349560b7.js"><link rel="prefetch" href="/design-pattern/assets/js/39.1462d1dd.js"><link rel="prefetch" href="/design-pattern/assets/js/4.81f7c0d7.js"><link rel="prefetch" href="/design-pattern/assets/js/40.cc7739ed.js"><link rel="prefetch" href="/design-pattern/assets/js/41.30b4b76c.js"><link rel="prefetch" href="/design-pattern/assets/js/42.d4f9a883.js"><link rel="prefetch" href="/design-pattern/assets/js/43.3c75efc8.js"><link rel="prefetch" href="/design-pattern/assets/js/44.254cfecb.js"><link rel="prefetch" href="/design-pattern/assets/js/45.f970681e.js"><link rel="prefetch" href="/design-pattern/assets/js/46.2b6dc672.js"><link rel="prefetch" href="/design-pattern/assets/js/47.51bcccb8.js"><link rel="prefetch" href="/design-pattern/assets/js/48.a9a64665.js"><link rel="prefetch" href="/design-pattern/assets/js/49.56e52fda.js"><link rel="prefetch" href="/design-pattern/assets/js/5.d43c6033.js"><link rel="prefetch" href="/design-pattern/assets/js/50.024ee7ff.js"><link rel="prefetch" href="/design-pattern/assets/js/51.e23e7e1b.js"><link rel="prefetch" href="/design-pattern/assets/js/52.ddc4950d.js"><link rel="prefetch" href="/design-pattern/assets/js/53.56beec5d.js"><link rel="prefetch" href="/design-pattern/assets/js/54.cbec228c.js"><link rel="prefetch" href="/design-pattern/assets/js/6.686b6a92.js"><link rel="prefetch" href="/design-pattern/assets/js/7.1103645d.js"><link rel="prefetch" href="/design-pattern/assets/js/8.4dcd5424.js"><link rel="prefetch" href="/design-pattern/assets/js/9.01bd6308.js">
    <link rel="stylesheet" href="/design-pattern/assets/css/0.styles.5341db10.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/design-pattern/" class="home-link router-link-active"><!----> <span class="site-name">JAVA设计模式</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/design-pattern/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/senjyouhara/design-pattern" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/design-pattern/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/senjyouhara/design-pattern" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>设计模式</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design-pattern/设计模式/0.0-概述.html" class="sidebar-link">软件设计模式概述</a></li><li><a href="/design-pattern/设计模式/0.1-GoF 的 23 种设计模式的分类和功能.html" class="sidebar-link">GoF 的 23 种设计模式的分类和功能</a></li><li><a href="/design-pattern/设计模式/0.2-UML统一建模语言是什么？.html" class="sidebar-link">UML统一建模语言是什么？</a></li><li><a href="/design-pattern/设计模式/0.3-UML类图及类图之间的关系.html" class="sidebar-link">UML类图及类图之间的关系</a></li><li><a href="/design-pattern/设计模式/0.4-类关系记忆技巧.html" class="sidebar-link">类关系记忆技巧</a></li><li><a href="/design-pattern/设计模式/0.5-UMLet的使用与类图的设计.html" class="sidebar-link">UMLet的使用与类图的设计</a></li><li><a href="/design-pattern/设计模式/0.6-什么才是优秀的软件架构？.html" class="sidebar-link">什么才是优秀的软件架构？</a></li><li><a href="/design-pattern/设计模式/0.7-如何正确使用设计模式？.html" class="sidebar-link">如何正确使用设计模式？</a></li><li><a href="/design-pattern/设计模式/01-开闭原则——面向对象设计原则.html" class="sidebar-link">开闭原则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/02-里氏替换原则——面向对象设计原则.html" class="sidebar-link">里氏替换原则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/03-依赖倒置原则——面向对象设计原则.html" class="sidebar-link">依赖倒置原则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/04-单一职责原则——面向对象设计原则.html" class="sidebar-link">单一职责原则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/05-接口隔离原则——面向对象设计原则.html" class="sidebar-link">接口隔离原则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/06-迪米特法则——面向对象设计原则.html" class="sidebar-link">迪米特法则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/07-合成复用原则——面向对象设计原则.html" class="sidebar-link">合成复用原则——面向对象设计原则</a></li><li><a href="/design-pattern/设计模式/08-一句话总结软件设计七大原则.html" class="sidebar-link">一句话总结软件设计七大原则</a></li><li><a href="/design-pattern/设计模式/09-创建型模式的特点和分类.html" class="sidebar-link">创建型模式的特点和分类</a></li><li><a href="/design-pattern/设计模式/10-单例模式.html" class="sidebar-link">单例模式</a></li><li><a href="/design-pattern/设计模式/11-原型模式.html" class="sidebar-link">原型模式</a></li><li><a href="/design-pattern/设计模式/12-简单工厂模式.html" class="sidebar-link">简单工厂模式</a></li><li><a href="/design-pattern/设计模式/13-工厂方法模式.html" class="sidebar-link">工厂方法模式</a></li><li><a href="/design-pattern/设计模式/14-抽象工厂模式.html" class="sidebar-link">抽象工厂模式</a></li><li><a href="/design-pattern/设计模式/15-建造者模式.html" class="sidebar-link">建造者模式</a></li><li><a href="/design-pattern/设计模式/16-创建型模式应用实验.html" class="sidebar-link">创建型模式应用实验</a></li><li><a href="/design-pattern/设计模式/17-结构型模式概述.html" class="sidebar-link">结构型模式概述</a></li><li><a href="/design-pattern/设计模式/18-代理模式.html" class="sidebar-link">代理模式</a></li><li><a href="/design-pattern/设计模式/19-适配器模式.html" class="sidebar-link">适配器模式</a></li><li><a href="/design-pattern/设计模式/20-桥接模式.html" class="sidebar-link">桥接模式</a></li><li><a href="/design-pattern/设计模式/21-装饰器模式.html" class="sidebar-link">装饰器模式</a></li><li><a href="/design-pattern/设计模式/22-外观模式.html" class="sidebar-link">外观模式</a></li><li><a href="/design-pattern/设计模式/23-享元模式.html" class="sidebar-link">享元模式</a></li><li><a href="/design-pattern/设计模式/24-组合模式.html" class="sidebar-link">组合模式</a></li><li><a href="/design-pattern/设计模式/25-结构型模式应用实验.html" class="sidebar-link">结构型模式应用实验</a></li><li><a href="/design-pattern/设计模式/26-行为型模式概述.html" class="sidebar-link">行为型模式概述</a></li><li><a href="/design-pattern/设计模式/27-模板方法模式.html" class="sidebar-link">模板方法模式</a></li><li><a href="/design-pattern/设计模式/28-策略模式.html" class="sidebar-link">策略模式</a></li><li><a href="/design-pattern/设计模式/29-命令模式.html" class="sidebar-link">命令模式</a></li><li><a href="/design-pattern/设计模式/30-责任链模式.html" class="sidebar-link">责任链模式</a></li><li><a href="/design-pattern/设计模式/31-状态模式.html" class="sidebar-link">状态模式</a></li><li><a href="/design-pattern/设计模式/32-观察者模式.html" class="active sidebar-link">观察者模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design-pattern/设计模式/32-观察者模式.html#观察者模式" class="sidebar-link">观察者模式</a></li></ul></li><li><a href="/design-pattern/设计模式/33-中介者模式.html" class="sidebar-link">中介者模式</a></li><li><a href="/design-pattern/设计模式/34-迭代器模式.html" class="sidebar-link">迭代器模式</a></li><li><a href="/design-pattern/设计模式/35-访问者模式.html" class="sidebar-link">访问者模式</a></li><li><a href="/design-pattern/设计模式/36-备忘录模式.html" class="sidebar-link">备忘录模式</a></li><li><a href="/design-pattern/设计模式/37-解释器模式.html" class="sidebar-link">解释器模式</a></li><li><a href="/design-pattern/设计模式/38-行为型模式应用实验.html" class="sidebar-link">行为型模式应用实验</a></li><li><a href="/design-pattern/设计模式/39-一句话归纳设计模式.html" class="sidebar-link">一句话归纳设计模式</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="观察者模式"><a href="#观察者模式" class="header-anchor">#</a> 观察者模式</h2> <p>在现实世界中，许多对象并不是独立存在的，其中一个对象的行为发生改变可能会导致一个或者多个其他对象的行为也发生改变。例如，某种商品的物价上涨时会导致部分商家高兴，而消费者伤心；还有，当我们开车到交叉路口时，遇到红灯会停，遇到绿灯会行。这样的例子还有很多，例如，股票价格与股民、微信公众号与微信用户、气象局的天气预报与听众、小偷与警察等。</p> <p>在软件世界也是这样，例如，Excel 中的数据与折线图、饼状图、柱状图之间的关系；MVC 模式中的模型与视图的关系；事件模型中的事件源与事件处理者。所有这些，如果用观察者模式来实现就非常方便。</p> <h3 id="模式的定义与特点"><a href="#模式的定义与特点" class="header-anchor">#</a> 模式的定义与特点</h3> <p>观察者（Observer）模式的定义：指多个对象间存在一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。这种模式有时又称作发布-订阅模式、模型-视图模式，它是对象行为型模式。</p> <p>观察者模式是一种对象行为型模式，其主要优点如下。</p> <ul><li>降低了目标与观察者之间的耦合关系，两者之间是抽象耦合关系。符合依赖倒置原则。</li> <li>目标与观察者之间建立了一套触发机制。</li></ul> <p>它的主要缺点如下。</p> <ul><li>目标与观察者之间的依赖关系并没有完全解除，而且有可能出现循环引用。</li> <li>当观察者对象很多时，通知的发布会花费很多时间，影响程序的效率。</li></ul> <h3 id="模式的结构与实现"><a href="#模式的结构与实现" class="header-anchor">#</a> 模式的结构与实现</h3> <p>实现观察者模式时要注意具体目标对象和具体观察者对象之间不能直接调用，否则将使两者之间紧密耦合起来，这违反了面向对象的设计原则。</p> <h5 id="_1-模式的结构"><a href="#_1-模式的结构" class="header-anchor">#</a> 1. 模式的结构</h5> <p>观察者模式的主要角色如下。</p> <ul><li>抽象主题（Subject）角色：也叫抽象目标类，它提供了一个用于保存观察者对象的聚集类和增加、删除观察者对象的方法，以及通知所有观察者的抽象方法。</li> <li>具体主题（Concrete Subject）角色：也叫具体目标类，它实现抽象目标中的通知方法，当具体主题的内部状态发生改变时，通知所有注册过的观察者对象。</li> <li>抽象观察者（Observer）角色：它是一个抽象类或接口，它包含了一个更新自己的抽象方法，当接到具体主题的更改通知时被调用。</li> <li>具体观察者（Concrete Observer）角色：实现抽象观察者中定义的抽象方法，以便在得到目标的更改通知时更新自身的状态。</li></ul> <p>观察者模式的结构图如图所示。</p> <p><img src="/design-pattern/assets/img/3-1Q1161A6221S.4ad3e0b3.gif" alt=""></p> <h5 id="_2-模式的实现"><a href="#_2-模式的实现" class="header-anchor">#</a> 2. 模式的实现</h5> <p>观察者模式的实现代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">net<span class="token punctuation">.</span>biancheng<span class="token punctuation">.</span>c<span class="token punctuation">.</span>observer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ObserverPattern</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Observer</span> obs1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteObserver1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Observer</span> obs2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteObserver2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        subject<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obs1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        subject<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obs2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        subject<span class="token punctuation">.</span><span class="token function">notifyObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//抽象目标</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Observer</span><span class="token punctuation">&gt;</span></span> observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Observer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//增加观察者方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//删除观察者方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        observers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">notifyObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通知观察者方法</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体目标</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteSubject</span> <span class="token keyword">extends</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notifyObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;具体目标发生改变...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;--------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> obs <span class="token operator">:</span> observers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Observer</span><span class="token punctuation">)</span> obs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//抽象观察者</span>
<span class="token keyword">interface</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//反应</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者1</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteObserver1</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;具体观察者1作出反应！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者1</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteObserver2</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;具体观察者2作出反应！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>程序运行结果如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>具体目标发生改变...
--------------
具体观察者1作出反应！
具体观察者2作出反应！
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="模式的应用实例"><a href="#模式的应用实例" class="header-anchor">#</a> 模式的应用实例</h3> <p>【例1】利用观察者模式设计一个程序，分析“人民币汇率”的升值或贬值对进口公司进口产品成本或出口公司的出口产品收入以及公司利润率的影响。</p> <p>分析：当“人民币汇率”升值时，进口公司的进口产品成本降低且利润率提升，出口公司的出口产品收入降低且利润率降低；当“人民币汇率”贬值时，进口公司的进口产品成本提升且利润率降低，出口公司的出口产品收入提升且利润率提升。</p> <p>这里的汇率（Rate）类是抽象目标类，它包含了保存观察者（Company）的 List 和增加/删除观察者的方法，以及有关汇率改变的抽象方法 change(int number)；而人民币汇率（RMBrate）类是具体目标， 它实现了父类的 change(int number) 方法，即当人民币汇率发生改变时通过相关公司；公司（Company）类是抽象观察者，它定义了一个有关汇率反应的抽象方法 response(int number)；进口公司（ImportCompany）类和出口公司（ExportCompany）类是具体观察者类，它们实现了父类的 response(int number) 方法，即当它们接收到汇率发生改变的通知时作为相应的反应。图 2 所示是其结构图。</p> <p><img src="/design-pattern/assets/img/3-1Q1161A646395.cfabe3cf.gif" alt=""></p> <p>程序代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">net<span class="token punctuation">.</span>biancheng<span class="token punctuation">.</span>c<span class="token punctuation">.</span>observer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RMBrateTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Rate</span> rate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RMBrate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Company</span> watcher1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImportCompany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Company</span> watcher2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExportCompany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rate<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>watcher1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rate<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>watcher2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rate<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rate<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//抽象目标：汇率</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Rate</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Company</span><span class="token punctuation">&gt;</span></span> companys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Company</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//增加观察者方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Company</span> company<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        companys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>company<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//删除观察者方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Company</span> company<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        companys<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>company<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体目标：人民币汇率</span>
<span class="token keyword">class</span> <span class="token class-name">RMBrate</span> <span class="token keyword">extends</span> <span class="token class-name">Rate</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Company</span> obs <span class="token operator">:</span> companys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Company</span><span class="token punctuation">)</span> obs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">response</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//抽象观察者：公司</span>
<span class="token keyword">interface</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者1：进口公司</span>
<span class="token keyword">class</span> <span class="token class-name">ImportCompany</span> <span class="token keyword">implements</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;人民币汇率升值&quot;</span> <span class="token operator">+</span> number <span class="token operator">+</span> <span class="token string">&quot;个基点，降低了进口产品成本，提升了进口公司利润率。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;人民币汇率贬值&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>number<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;个基点，提升了进口产品成本，降低了进口公司利润率。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者2：出口公司</span>
<span class="token keyword">class</span> <span class="token class-name">ExportCompany</span> <span class="token keyword">implements</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;人民币汇率升值&quot;</span> <span class="token operator">+</span> number <span class="token operator">+</span> <span class="token string">&quot;个基点，降低了出口产品收入，降低了出口公司的销售利润率。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;人民币汇率贬值&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>number<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;个基点，提升了出口产品收入，提升了出口公司的销售利润率。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>程序运行结果如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>人民币汇率升值10个基点，降低了进口产品成本，提升了进口公司利润率。
人民币汇率升值10个基点，降低了出口产品收入，降低了出口公司的销售利润率。
人民币汇率贬值9个基点，提升了进口产品成本，降低了进口公司利润率。
人民币汇率贬值9个基点，提升了出口产品收入，提升了出口公司的销售利润率。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>观察者模式在软件幵发中用得最多的是窗体程序设计中的事件处理，窗体中的所有组件都是“事件源”，也就是目标对象，而事件处理程序类的对象是具体观察者对象。下面以一个学校铃声的事件处理程序为例，介绍 Windows 中的“事件处理模型”的工作原理。</p> <p>【例2】利用观察者模式设计一个学校铃声的事件处理程序。</p> <p>分析：在本实例中，学校的“铃”是事件源和目标，“老师”和“学生”是事件监听器和具体观察者，“铃声”是事件类。学生和老师来到学校的教学区，都会注意学校的铃，这叫事件绑定；当上课时间或下课时间到，会触发铃发声，这时会生成“铃声”事件；学生和老师听到铃声会开始上课或下课，这叫事件处理。这个实例非常适合用观察者模式实现，图 3 给出了学校铃声的事件模型。</p> <p><img src="data:image/gif;base64,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" alt=""></p> <p>现在用“观察者模式”来实现该事件处理模型。</p> <p>首先，定义一个铃声事件（RingEvent）类，它记录了铃声的类型（上课铃声/下课铃声）。</p> <p>再定义一个学校的铃（BellEventSource）类，它是事件源，是观察者目标类，该类里面包含了监听器容器 listener，可以绑定监听者（学生或老师），并且有产生铃声事件和通知所有监听者的方法。</p> <p>然后，定义铃声事件监听者（BellEventListener）类，它是抽象观察者，它包含了铃声事件处理方法 heardBell(RingEvent e)。</p> <p>最后，定义老师类（TeachEventListener）和学生类（StuEventListener），它们是事件监听器，是具体观察者，听到铃声会去上课或下课。图 4 给出了学校铃声事件处理程序的结构。</p> <p><img src="/design-pattern/assets/img/3-1Q1161AP0K8.4a3904b8.gif" alt=""></p> <p>程序代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">net<span class="token punctuation">.</span>biancheng<span class="token punctuation">.</span>c<span class="token punctuation">.</span>observer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BellEventTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BellEventSource</span> bell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BellEventSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//铃（事件源）</span>
        bell<span class="token punctuation">.</span><span class="token function">addPersonListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TeachEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注册监听器（老师）</span>
        bell<span class="token punctuation">.</span><span class="token function">addPersonListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StuEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//注册监听器（学生）</span>
        bell<span class="token punctuation">.</span><span class="token function">ring</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//打上课铃声</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bell<span class="token punctuation">.</span><span class="token function">ring</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//打下课铃声</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//铃声事件类：用于封装事件源及一些与事件相关的参数</span>
<span class="token keyword">class</span> <span class="token class-name">RingEvent</span> <span class="token keyword">extends</span> <span class="token class-name">EventObject</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> sound<span class="token punctuation">;</span>    <span class="token comment">//true表示上课铃声,false表示下课铃声</span>
    <span class="token keyword">public</span> <span class="token class-name">RingEvent</span><span class="token punctuation">(</span><span class="token class-name">Object</span> source<span class="token punctuation">,</span> <span class="token keyword">boolean</span> sound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sound <span class="token operator">=</span> sound<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSound</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> sound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sound <span class="token operator">=</span> sound<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">getSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sound<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//目标类：事件源，铃</span>
<span class="token keyword">class</span> <span class="token class-name">BellEventSource</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BellEventListener</span><span class="token punctuation">&gt;</span></span> listener<span class="token punctuation">;</span> <span class="token comment">//监听器容器</span>
    <span class="token keyword">public</span> <span class="token class-name">BellEventSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BellEventListener</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//给事件源绑定监听器</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addPersonListener</span><span class="token punctuation">(</span><span class="token class-name">BellEventListener</span> ren<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        listener<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ren<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//事件触发器：敲钟，当铃声sound的值发生变化时，触发事件。</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> sound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> type <span class="token operator">=</span> sound <span class="token operator">?</span> <span class="token string">&quot;上课铃&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;下课铃&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>type <span class="token operator">+</span> <span class="token string">&quot;响！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RingEvent</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RingEvent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> sound<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">notifies</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//通知注册在该事件源上的所有监听器</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//当事件发生时,通知绑定在该事件源上的所有监听器做出反应（调用事件处理方法）</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">notifies</span><span class="token punctuation">(</span><span class="token class-name">RingEvent</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BellEventListener</span> ren <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BellEventListener</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> listener<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ren <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ren<span class="token punctuation">.</span><span class="token function">heardBell</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//抽象观察者类：铃声事件监听器</span>
<span class="token keyword">interface</span> <span class="token class-name">BellEventListener</span> <span class="token keyword">extends</span> <span class="token class-name">EventListener</span> <span class="token punctuation">{</span>
    <span class="token comment">//事件处理方法，听到铃声</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">heardBell</span><span class="token punctuation">(</span><span class="token class-name">RingEvent</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者类：老师事件监听器</span>
<span class="token keyword">class</span> <span class="token class-name">TeachEventListener</span> <span class="token keyword">implements</span> <span class="token class-name">BellEventListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">heardBell</span><span class="token punctuation">(</span><span class="token class-name">RingEvent</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;老师上课了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;老师下课了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者类：学生事件监听器</span>
<span class="token keyword">class</span> <span class="token class-name">StuEventListener</span> <span class="token keyword">implements</span> <span class="token class-name">BellEventListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">heardBell</span><span class="token punctuation">(</span><span class="token class-name">RingEvent</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;同学们，上课了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;同学们，下课了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div><p>程序运行结果如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>上课铃响！
老师上课了...
同学们，上课了...
------------
下课铃响！
老师下课了...
同学们，下课了...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="模式的应用场景"><a href="#模式的应用场景" class="header-anchor">#</a> 模式的应用场景</h3> <p>在软件系统中，当系统一方行为依赖另一方行为的变动时，可使用观察者模式松耦合联动双方，使得一方的变动可以通知到感兴趣的另一方对象，从而让另一方对象对此做出响应。</p> <p>通过前面的分析与应用实例可知观察者模式适合以下几种情形。</p> <ul><li>对象间存在一对多关系，一个对象的状态发生改变会影响其他对象。</li> <li>当一个抽象模型有两个方面，其中一个方面依赖于另一方面时，可将这二者封装在独立的对象中以使它们可以各自独立地改变和复用。</li> <li>实现类似广播机制的功能，不需要知道具体收听者，只需分发广播，系统中感兴趣的对象会自动接收该广播。</li> <li>多层级嵌套使用，形成一种链式触发机制，使得事件具备跨域（跨越两种观察者类型）通知。</li></ul> <h3 id="模式的扩展"><a href="#模式的扩展" class="header-anchor">#</a> 模式的扩展</h3> <p>在 Java 中，通过 java.util.Observable 类和 java.util.Observer 接口定义了观察者模式，只要实现它们的子类就可以编写观察者模式实例。</p> <h5 id="_1-observable类"><a href="#_1-observable类" class="header-anchor">#</a> 1. Observable类</h5> <p>Observable 类是抽象目标类，它有一个 Vector 向量，用于保存所有要通知的观察者对象，下面来介绍它最重要的 3 个方法。
void addObserver(Observer o) 方法：用于将新的观察者对象添加到向量中。
void notifyObservers(Object arg) 方法：调用向量中的所有观察者对象的 update() 方法，通知它们数据发生改变。通常越晚加入向量的观察者越先得到通知。
void setChange() 方法：用来设置一个 boolean 类型的内部标志位，注明目标对象发生了变化。当它为真时，notifyObservers() 才会通知观察者。</p> <h5 id="_2-observer-接口"><a href="#_2-observer-接口" class="header-anchor">#</a> 2. Observer 接口</h5> <p>Observer 接口是抽象观察者，它监视目标对象的变化，当目标对象发生变化时，观察者得到通知，并调用 void update(Observable o,Object arg) 方法，进行相应的工作。</p> <p>【例3】利用 Observable 类和 Observer 接口实现原油期货的观察者模式实例。</p> <p>分析：当原油价格上涨时，空方伤心，多方局兴；当油价下跌时，空方局兴，多方伤心。本实例中的抽象目标（Observable）类在 Java 中已经定义，可以直接定义其子类，即原油期货（OilFutures）类，它是具体目标类，该类中定义一个 SetPriCe(float price) 方法，当原油数据发生变化时调用其父类的 notifyObservers(Object arg) 方法来通知所有观察者；另外，本实例中的抽象观察者接口（Observer）在 Java 中已经定义，只要定义其子类，即具体观察者类（包括多方类 Bull 和空方类 Bear），并实现 update(Observable o,Object arg) 方法即可。图 5 所示是其结构图。</p> <p><img src="/design-pattern/assets/img/3-1Q1161ARKO.383530d5.gif" alt=""></p> <p>程序代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">net<span class="token punctuation">.</span>biancheng<span class="token punctuation">.</span>c<span class="token punctuation">.</span>observer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Observer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Observable</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CrudeOilFutures</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">OilFutures</span> oil <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OilFutures</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Observer</span> bull <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//多方</span>
        <span class="token class-name">Observer</span> bear <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//空方</span>
        oil<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>bull<span class="token punctuation">)</span><span class="token punctuation">;</span>
        oil<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>bear<span class="token punctuation">)</span><span class="token punctuation">;</span>
        oil<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oil<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体目标类：原油期货</span>
<span class="token keyword">class</span> <span class="token class-name">OilFutures</span> <span class="token keyword">extends</span> <span class="token class-name">Observable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">float</span> price<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">float</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token keyword">float</span> price<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">setChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//设置内部标志位，注明数据发生变化</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">notifyObservers</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//通知观察者价格改变了</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者类：多方</span>
<span class="token keyword">class</span> <span class="token class-name">Bull</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Observable</span> o<span class="token punctuation">,</span> <span class="token class-name">Object</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Float</span> price <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Float</span><span class="token punctuation">)</span> arg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">floatValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>price <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;油价上涨&quot;</span> <span class="token operator">+</span> price <span class="token operator">+</span> <span class="token string">&quot;元，多方高兴了！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;油价下跌&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>price<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;元，多方伤心了！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//具体观察者类：空方</span>
<span class="token keyword">class</span> <span class="token class-name">Bear</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Observable</span> o<span class="token punctuation">,</span> <span class="token class-name">Object</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Float</span> price <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Float</span><span class="token punctuation">)</span> arg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">floatValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>price <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;油价上涨&quot;</span> <span class="token operator">+</span> price <span class="token operator">+</span> <span class="token string">&quot;元，空方伤心了！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;油价下跌&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>price<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;元，空方高兴了！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>程序运行结果如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>油价上涨10.0元，空方伤心了！
油价上涨10.0元，多方高兴了！
油价下跌8.0元，空方高兴了！
油价下跌8.0元，多方伤心了！
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/27/2022, 2:55:59 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/design-pattern/设计模式/31-状态模式.html" class="prev">
        状态模式
      </a></span> <span class="next"><a href="/design-pattern/设计模式/33-中介者模式.html">
        中介者模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/design-pattern/assets/js/app.45f4ed8b.js" defer></script><script src="/design-pattern/assets/js/2.dd66b6b4.js" defer></script><script src="/design-pattern/assets/js/13.8387bba7.js" defer></script>
  </body>
</html>
